!function(t){function e(t){t+="";var e=t.charAt(0).toUpperCase();return e+t.substr(1)}function n(e,s){var o=t(e).data(i);return o?o:(this.settings=t.extend({},n.defaultSettings,s),this.$content=t(e),this._init(),void this.$content.data(i,this))}var i="__apfm__",s="apfm-",o="apfm",r="apfm",a=0;String.prototype.ucfirst||(String.prototype.ucfirst=function(){return e(this)}),n.prototype={_init:function(){this.opened=!1,this._addContainer(),this._applyContent(),this._updateHeadCss(),this._bind(),this.settings.autoOpen&&this.open()},_addContainer:function(){this.$container=t(n.template),this.$container.appendTo(t("body")).attr("id",s+"container-"+a++).css("background-color",this.settings.backgroundColor),this.$wrapper=this.$container.find("."+s+"wrapper"),this.$closeButton=this.$container.find("."+s+"close-button"),this.settings.showCloseButton||this.$closeButton.hide()},_removeContainer:function(){this.$container.remove()},_applyContent:function(){this.$placeholder=t("<div></div>",{"class":s+"placeholder"}),this.$content.after(this.$placeholder),this.$content.appendTo(this.$wrapper),this.$content.attr("tabIndex",-1)},_resetContent:function(){this.$placeholder.insertAfter(this.$placeholder),this.$placeholder.remove(),this.$placeholder=void 0,this.$content.removeAttr("tabIndex")},_updateHeadCss:function(){this._removeHeadCss();var e=this.$container.attr("id"),n=(parseInt(this.settings.animationDuration)/1e3).toFixed(3)+"s",i="#"+e+" {\n";t.each(["-webkit-","-moz-","-ms-","-o-",""],function(t,e){i+="	"+e+"transition: "+e+"transform "+n+", opacity "+n+";\n"}),i+="}\n",this.headCssStyle=t("<style type='text/css'>\n"+i+"\n</style>").appendTo("head"),this._trigger("updateHeadCss",[i])},_removeHeadCss:function(){this.headCssStyle&&(this.headCssStyle.remove(),this.headCssStyle=null,this._trigger("removeHeadCss"))},_bind:function(){var e=this;this.settings.openSelector&&t(this.settings.openSelector).on("click."+o,function(){return e.open(t(this)),!1}),this.settings.closeSelector&&this.$container.on("click."+o,this.settings.closeSelector,function(){return e.close(),!1}),this.$content.on("keydown."+o,function(t){e.opened&&27==t.keyCode&&(e.close(),t.preventDefault())})},_unbind:function(){this.$content.find(this.settings.openSelector).on("click."+o),this.$content.find(this.settings.closeSelector).on("click."+o),this.$content.off("keydown."+o)},_trigger:function(t,e){var n="on"+t.ucfirst(),i=this.settings[n];"function"==typeof i&&i.apply(this.$content,e),t=r+t.ucfirst(),this.$content.trigger(t,e)},_triggerHandler:function(t,e){var n,i="on"+t.ucfirst(),s=this.settings[i],o=void 0;return"function"==typeof s&&(o=s.apply(this.$content,e)),t=r+t.ucfirst(),n=void 0!==(n=this.$content.triggerHandler(t,e))?n:o},open:function(){var e=this;this.opened||this._triggerHandler("beforeOpen")!==!1&&(this.opened=!0,t("html").addClass(s+"open"),this.$container.scrollTop(-1e3).addClass(s+"open "+s+"opening"),this.$content.focus(),setTimeout(function(){e.$container.removeClass(s+"opening")},this.settings.animationDuration),this._trigger("open"))},close:function(){var e=this;this.opened&&this._triggerHandler("beforeClose")!==!1&&(this.$container.addClass(s+"closing").removeClass(s+"open"),setTimeout(function(){e.$container.removeClass(s+"closing"),t("html").removeClass(s+"open"),e.opened=!1},this.settings.animationDuration),this._trigger("close"))},isOpen:function(){return this.opened},option:function(e,n){if(!e)return t.extend({},this.settings);var i;if("string"==typeof e){if(1===arguments.length)return void 0!==this.settings[e]?this.settings[e]:null;i={},i[e]=n}else i=e;this._setOptions(i)},_setOptions:function(t){for(key in t){var e=t[key];this.settings[key]=e}},destroy:function(){this._trigger("destroy"),this.opened&&this.close(),this._unbind(),this._removeHeadCss(),this._resetContent(),this._removeContainer(),this.$elements.each(function(){t(this).removeData(i)})}},t.fn.apFullscreenModal=function(e){if("string"==typeof e){var s,o,r=[],a=Array.prototype.slice.call(arguments,1);return this.each(function(){if(s=t(this).data(i)){if("function"==typeof(o=s[e])&&"_"!==e.charAt(0)){var n=o.apply(s,a);void 0!==n&&r.push(n)}}else r.push(void 0)}),r.length?1===r.length?r[0]:r:this}return this.each(function(){new n(this,e)})},n.defaultSettings={backgroundColor:"#fff",openSelector:void 0,autoOpen:!1,closeSelector:".close-modal",showCloseButton:!0,animationDuration:200},n.template='<div class="'+s+'container"><div class="'+s+"wrapper "+s+'clearfix"><div class="'+s+'close-button close-modal"></div></div></div>'}(jQuery);